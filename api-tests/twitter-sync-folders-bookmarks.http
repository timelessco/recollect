### Sync Folder Bookmarks (Success - Single Link)
# New App Router endpoint: /api/twitter/sync-folder-bookmarks (queue producer)
# Response: { data: { queued: N }, error: null }
# Link messages are enqueued to twitter_imports queue after bookmark messages
# Prerequisites:
# 1. Category must exist (create via /twitter/sync-folders)
# 2. Bookmark must be created first (via /twitter/sync â†’ worker processes it)
POST {{$dotenv API_BASE_URL}}/twitter/sync-folder-bookmarks
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "mappings": [
    {
      "category_name": "Tech Tweets",
      "url": "https://x.com/SawyerMerritt/status/1986170355535286529"
    }
  ]
}

### Sync Multiple Folder Bookmarks
POST {{$dotenv API_BASE_URL}}/twitter/sync-folder-bookmarks
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "mappings": [
    {
      "category_name": "Tech Tweets",
      "url": "https://x.com/narendramodi/status/1984243645050945961"
    },
    {
      "category_name": "Design Inspiration",
      "url": "https://x.com/elonmusk/status/1985699323099713668"
    }
  ]
}

### Sync Same Bookmark to Multiple Categories
# One bookmark can belong to multiple categories
POST {{$dotenv API_BASE_URL}}/twitter/sync-folder-bookmarks
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "mappings": [
    {
      "category_name": "Tech Tweets",
      "url": "https://x.com/testuser/status/1990000000000000001"
    },
    {
      "category_name": "Design Inspiration",
      "url": "https://x.com/testuser/status/1990000000000000001"
    },
    {
      "category_name": "Productivity Tips",
      "url": "https://x.com/testuser/status/1990000000000000001"
    }
  ]
}

### Large Batch Test (6 mappings)
POST {{$dotenv API_BASE_URL}}/twitter/sync-folder-bookmarks
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "mappings": [
    {
      "category_name": "Tech Tweets",
      "url": "https://x.com/testuser/status/1990000000000000010"
    },
    {
      "category_name": "Tech Tweets",
      "url": "https://x.com/testuser/status/1990000000000000011"
    },
    {
      "category_name": "Tech Tweets",
      "url": "https://x.com/testuser/status/1990000000000000012"
    },
    {
      "category_name": "Design Inspiration",
      "url": "https://x.com/testuser/status/1990000000000000013"
    },
    {
      "category_name": "Design Inspiration",
      "url": "https://x.com/testuser/status/1990000000000000014"
    },
    {
      "category_name": "Productivity Tips",
      "url": "https://x.com/testuser/status/1990000000000000015"
    }
  ]
}

### Validation Error - Empty Mappings Array
# Expected: 400 - At least one mapping required
POST {{$dotenv API_BASE_URL}}/twitter/sync-folder-bookmarks
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "mappings": []
}

### Validation Error - Missing Mappings Field
# Expected: 400 - Zod validation error
POST {{$dotenv API_BASE_URL}}/twitter/sync-folder-bookmarks
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{}

### Validation Error - Missing Category Name
# Expected: 400 - category_name is required
POST {{$dotenv API_BASE_URL}}/twitter/sync-folder-bookmarks
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "mappings": [
    {
      "url": "https://x.com/testuser/status/1990000000000000001"
    }
  ]
}

### Validation Error - Empty Category Name
# Expected: 400 - category_name min length 1
POST {{$dotenv API_BASE_URL}}/twitter/sync-folder-bookmarks
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "mappings": [
    {
      "category_name": "",
      "url": "https://x.com/testuser/status/1990000000000000001"
    }
  ]
}

### Validation Error - Missing URL
# Expected: 400 - url is required
POST {{$dotenv API_BASE_URL}}/twitter/sync-folder-bookmarks
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "mappings": [
    {
      "category_name": "Tech Tweets"
    }
  ]
}

### Validation Error - Invalid URL Format
# Expected: 400 - url must be a valid URL
POST {{$dotenv API_BASE_URL}}/twitter/sync-folder-bookmarks
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "mappings": [
    {
      "category_name": "Tech Tweets",
      "url": "not-a-valid-url"
    }
  ]
}

### Auth Error - No Token
# Expected: 401 - Not authenticated
POST {{$dotenv API_BASE_URL}}/twitter/sync-folder-bookmarks
Content-Type: application/json

{
  "mappings": [
    {
      "category_name": "Tech Tweets",
      "url": "https://x.com/testuser/status/1990000000000000001"
    }
  ]
}
