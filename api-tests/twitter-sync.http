### Sync Twitter Tweet (Success)
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "https://x.com/testuser/status/TEST123",
    "title": "Test Twitter Tweet",
    "description": "Test description",
    "type": "tweet",
    "ogImage": "https://pbs.twimg.com/media/test.jpg",
    "sort_index": "100",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico",
      "twitter_avatar_url": "https://pbs.twimg.com/profile_images/test.jpg"
    }
  }]
}

### Sync Multiple Tweets (with different sort_index for ordering)
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [
    {
      "url": "https://x.com/testuser/status/BATCH001",
      "title": "Batch Tweet 1",
      "description": "First batch tweet",
      "type": "tweet",
      "ogImage": "https://pbs.twimg.com/media/batch1.jpg",
      "sort_index": "200",
      "meta_data": {
        "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
      }
    },
    {
      "url": "https://twitter.com/testuser/status/BATCH002",
      "title": "Batch Tweet 2",
      "description": "Second batch tweet",
      "type": "tweet",
      "ogImage": null,
      "sort_index": "199",
      "meta_data": {
        "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico",
        "video_url": "https://video.twimg.com/ext_tw_video/test.mp4"
      }
    }
  ]
}

### Sync Tweet with All Optional Fields
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "https://www.x.com/testuser/status/FULL001",
    "title": "Full Tweet",
    "description": "Tweet with all fields",
    "type": "tweet",
    "ogImage": "https://pbs.twimg.com/media/full.jpg",
    "sort_index": "150",
    "inserted_at": "2024-01-15T10:30:00.000Z",
    "category_name": "Test Category",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico",
      "twitter_avatar_url": "https://pbs.twimg.com/profile_images/avatar.jpg",
      "video_url": "https://video.twimg.com/ext_tw_video/video.mp4"
    }
  }]
}

### Validation Error - Empty Data Array
# Expected: 400 - Validation error (Zod schema validation)
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": []
}

### Auth Error - No Token
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Content-Type: application/json

{
  "data": [{
    "url": "https://x.com/interesting_aIl/status/2009045432358367692",
    "title": "No Auth Test",
    "description": "Test without auth",
    "type": "tweet",
    "ogImage": null,
    "sort_index": "100",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
    }
  }]
}

### Validation Error - Invalid URL Format (not a URL)
# Expected: 400 - Validation error
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "not-a-valid-url",
    "title": "Invalid URL Test",
    "description": "Test description",
    "type": "tweet",
    "ogImage": null,
    "sort_index": "100",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
    }
  }]
}

### Validation Error - Non-Twitter Hostname
# Expected: 400 - Validation error (if URL validation exists)
# Note: Twitter sync doesn't validate hostname at API level like Instagram
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "https://instagram.com/p/WRONG_HOST/",
    "title": "Wrong Hostname Test",
    "description": "Test description",
    "type": "tweet",
    "ogImage": null,
    "sort_index": "100",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
    }
  }]
}

### Validation Error - javascript: Protocol
# Expected: 400 - Validation error
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "javascript:alert('xss')",
    "title": "XSS Attempt Test",
    "description": "Test description",
    "type": "tweet",
    "ogImage": null,
    "sort_index": "100",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
    }
  }]
}

### Validation Error - Missing Required Field (favIcon)
# Expected: 400 - Validation error (favIcon is required in meta_data)
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "https://x.com/testuser/status/MISSING_FAVICON",
    "title": "Missing FavIcon Test",
    "description": "Test description",
    "type": "tweet",
    "ogImage": null,
    "sort_index": "100",
    "meta_data": {}
  }]
}

### Validation Error - Missing Required Field (sort_index)
# Expected: 400 - Validation error (sort_index is required)
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "https://x.com/testuser/status/MISSING_SORT",
    "title": "Missing Sort Index Test",
    "description": "Test description",
    "type": "tweet",
    "ogImage": null,
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
    }
  }]
}

### Validation Error - Missing Required Field (description)
# Expected: 400 - Validation error (description is required)
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "https://x.com/testuser/status/MISSING_DESC",
    "title": "Missing Description Test",
    "type": "tweet",
    "ogImage": null,
    "sort_index": "100",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
    }
  }]
}

### Validation Error - Invalid Type Field
# Expected: 400 - Validation error (type must be "tweet" for this endpoint)
# Note: Schema accepts any string, but endpoint filters by type="tweet" for duplicates
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "https://x.com/testuser/status/WRONG_TYPE",
    "title": "Wrong Type Test",
    "description": "Test description",
    "type": "instagram",
    "ogImage": null,
    "sort_index": "100",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
    }
  }]
}

### Duplicate Detection - All URLs Already Exist
# Expected: 404 - { success: true, error: "No data to insert", data: [] }
# This happens when all URLs in the payload already exist for this user
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "https://x.com/testuser/status/DUPLICATE",
    "title": "Duplicate Test",
    "description": "This URL already exists",
    "type": "tweet",
    "ogImage": null,
    "sort_index": "100",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
    }
  }]
}

### Success - Partial Duplicate (Some URLs New)
# Expected: 200 - { success: true, error: null }
# Only non-duplicate URLs are inserted
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [
    {
      "url": "https://x.com/testuser/status/EXISTING",
      "title": "Existing Tweet",
      "description": "This already exists",
      "type": "tweet",
      "ogImage": null,
      "sort_index": "100",
      "meta_data": {
        "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
      }
    },
    {
      "url": "https://x.com/testuser/status/NEW_TWEET",
      "title": "New Tweet",
      "description": "This is new",
      "type": "tweet",
      "ogImage": null,
      "sort_index": "101",
      "meta_data": {
        "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
      }
    }
  ]
}

### Test Twitter.com Domain (not just x.com)
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "https://twitter.com/testuser/status/TWITTER_DOMAIN",
    "title": "Twitter.com Domain Test",
    "description": "Using twitter.com instead of x.com",
    "type": "tweet",
    "ogImage": null,
    "sort_index": "100",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
    }
  }]
}

### Test www.x.com Domain
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "https://www.x.com/testuser/status/WWW_DOMAIN",
    "title": "www.x.com Domain Test",
    "description": "Using www.x.com",
    "type": "tweet",
    "ogImage": null,
    "sort_index": "100",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
    }
  }]
}

### Test www.twitter.com Domain
POST {{$dotenv API_BASE_URL}}/v1/twitter/sync
Authorization: Bearer {{$dotenv USER_TOKEN}}
Content-Type: application/json

{
  "data": [{
    "url": "https://www.twitter.com/testuser/status/WWW_TWITTER_DOMAIN",
    "title": "www.twitter.com Domain Test",
    "description": "Using www.twitter.com",
    "type": "tweet",
    "ogImage": null,
    "sort_index": "100",
    "meta_data": {
      "favIcon": "https://abs.twimg.com/favicons/twitter.3.ico"
    }
  }]
}
